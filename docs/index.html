<html>
<title>HTTP Benchmark Report Renderer</title>
<head>
    <!--Load the AJAX API-->
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
      google.charts.load('current', {'packages': ['corechart']});

      google.charts.setOnLoadCallback(onLoadCallback);

      const exampleReport = {
        "400": "Running 5m test @ http://example.com\n  4 threads and 8 connections\n  Thread calibration: mean lat.: 2020.805ms, rate sampling interval: 7106ms\n  Thread calibration: mean lat.: 1945.191ms, rate sampling interval: 6873ms\n  Thread calibration: mean lat.: 2017.467ms, rate sampling interval: 7077ms\n  Thread calibration: mean lat.: 1980.976ms, rate sampling interval: 7032ms\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\n    Latency     1.00m    32.35s    1.94m    57.65%\n    Req/Sec    61.05      1.11    64.00     96.32%\n  Latency Distribution (HdrHistogram - Recorded Latency)\n 50.000%    1.00m \n 75.000%    1.47m \n 90.000%    1.74m \n 99.000%    1.91m \n 99.900%    1.93m \n 99.990%    1.94m \n 99.999%    1.94m \n100.000%    1.94m \n\n  Detailed Percentile spectrum:\n       Value   Percentile   TotalCount 1/(1-Percentile)\n\n    3731.455     0.000000            1         1.00\n   15089.663     0.100000         7137         1.11\n   26132.479     0.200000        14276         1.25\n   37257.215     0.300000        21424         1.43\n   48234.495     0.400000        28550         1.67\n   59801.599     0.500000        35689         2.00\n   65404.927     0.550000        39254         2.22\n   70909.951     0.600000        42839         2.50\n   76873.727     0.650000        46418         2.86\n   82444.287     0.700000        49999         3.33\n   88080.383     0.750000        53548         4.00\n   90701.823     0.775000        55329         4.44\n   93585.407     0.800000        57124         5.00\n   96337.919     0.825000        58907         5.71\n   99155.967     0.850000        60714         6.67\n  101777.407     0.875000        62487         8.00\n  103022.591     0.887500        63344         8.89\n  104464.383     0.900000        64244        10.00\n  105906.175     0.912500        65120        11.43\n  107347.967     0.925000        66030        13.33\n  108789.759     0.937500        66922        16.00\n  109445.119     0.943750        67365        17.78\n  110166.015     0.950000        67825        20.00\n  110821.375     0.956250        68240        22.86\n  111476.735     0.962500        68708        26.67\n  112066.559     0.968750        69183        32.00\n  112328.703     0.971875        69357        35.56\n  112721.919     0.975000        69620        40.00\n  112984.063     0.978125        69813        45.71\n  113377.279     0.981250        70055        53.33\n  113704.959     0.984375        70255        64.00\n  113901.567     0.985938        70362        71.11\n  114098.175     0.987500        70477        80.00\n  114294.783     0.989062        70589        91.43\n  114491.391     0.990625        70720       106.67\n  114687.999     0.992188        70836       128.00\n  114753.535     0.992969        70870       142.22\n  114884.607     0.993750        70939       160.00\n  114950.143     0.994531        70976       182.86\n  115081.215     0.995313        71056       213.33\n  115146.751     0.996094        71084       256.00\n  115212.287     0.996484        71124       284.44\n  115277.823     0.996875        71151       320.00\n  115343.359     0.997266        71190       365.71\n  115408.895     0.997656        71211       426.67\n  115474.431     0.998047        71228       512.00\n  115539.967     0.998242        71250       568.89\n  115539.967     0.998437        71250       640.00\n  115605.503     0.998633        71270       731.43\n  115671.039     0.998828        71283       853.33\n  115802.111     0.999023        71296      1024.00\n  115867.647     0.999121        71301      1137.78\n  115933.183     0.999219        71308      1280.00\n  115998.719     0.999316        71313      1462.86\n  116129.791     0.999414        71321      1706.67\n  116260.863     0.999512        71336      2048.00\n  116260.863     0.999561        71336      2275.56\n  116260.863     0.999609        71336      2560.00\n  116326.399     0.999658        71341      2925.71\n  116326.399     0.999707        71341      3413.33\n  116391.935     0.999756        71350      4096.00\n  116391.935     0.999780        71350      4551.11\n  116391.935     0.999805        71350      5120.00\n  116391.935     0.999829        71350      5851.43\n  116457.471     0.999854        71354      6826.67\n  116457.471     0.999878        71354      8192.00\n  116457.471     0.999890        71354      9102.22\n  116523.007     0.999902        71361     10240.00\n  116523.007     1.000000        71361          inf\n#[Mean    =    59752.614, StdDeviation   =    32345.015]\n#[Max     =   116457.472, Total count    =        71361]\n#[Buckets =           27, SubBuckets     =         2048]\n----------------------------------------------------------\n  73813 requests in 5.00m, 477.53MB read\n  Non-2xx or 3xx responses: 11657\nRequests/sec:    246.03\nTransfer/sec:      1.59MB\n",
        "100": "Running 5m test @ http://example.com\n  4 threads and 8 connections\n  Thread calibration: mean lat.: 31.019ms, rate sampling interval: 84ms\n  Thread calibration: mean lat.: 34.192ms, rate sampling interval: 88ms\n  Thread calibration: mean lat.: 32.268ms, rate sampling interval: 85ms\n  Thread calibration: mean lat.: 34.762ms, rate sampling interval: 90ms\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\n    Latency    32.11ms   11.83ms  64.70ms   75.01%\n    Req/Sec    24.60      7.09    48.00     72.82%\n  Latency Distribution (HdrHistogram - Recorded Latency)\n 50.000%   35.55ms\n 75.000%   39.74ms\n 90.000%   43.42ms\n 99.000%   50.62ms\n 99.900%   56.45ms\n 99.990%   62.05ms\n 99.999%   64.74ms\n100.000%   64.74ms\n\n  Detailed Percentile spectrum:\n       Value   Percentile   TotalCount 1/(1-Percentile)\n\n       1.684     0.000000            1         1.00\n       9.623     0.100000         2901         1.11\n      26.335     0.200000         5800         1.25\n      30.463     0.300000         8701         1.43\n      33.407     0.400000        11639         1.67\n      35.551     0.500000        14502         2.00\n      36.447     0.550000        16001         2.22\n      37.247     0.600000        17443         2.50\n      38.015     0.650000        18851         2.86\n      38.847     0.700000        20302         3.33\n      39.743     0.750000        21762         4.00\n      40.223     0.775000        22499         4.44\n      40.735     0.800000        23220         5.00\n      41.311     0.825000        23939         5.71\n      41.951     0.850000        24671         6.67\n      42.591     0.875000        25376         8.00\n      43.007     0.887500        25760         8.89\n      43.423     0.900000        26118        10.00\n      43.871     0.912500        26470        11.43\n      44.415     0.925000        26834        13.33\n      45.055     0.937500        27205        16.00\n      45.375     0.943750        27372        17.78\n      45.791     0.950000        27552        20.00\n      46.271     0.956250        27735        22.86\n      46.751     0.962500        27913        26.67\n      47.327     0.968750        28099        32.00\n      47.679     0.971875        28187        35.56\n      48.063     0.975000        28275        40.00\n      48.447     0.978125        28370        45.71\n      48.895     0.981250        28460        53.33\n      49.343     0.984375        28548        64.00\n      49.663     0.985938        28593        71.11\n      50.047     0.987500        28642        80.00\n      50.367     0.989062        28684        91.43\n      50.783     0.990625        28729       106.67\n      51.199     0.992188        28774       128.00\n      51.487     0.992969        28797       142.22\n      51.711     0.993750        28821       160.00\n      52.031     0.994531        28842       182.86\n      52.575     0.995313        28866       213.33\n      53.055     0.996094        28887       256.00\n      53.375     0.996484        28899       284.44\n      53.631     0.996875        28910       320.00\n      53.951     0.997266        28922       365.71\n      54.431     0.997656        28933       426.67\n      54.783     0.998047        28944       512.00\n      55.295     0.998242        28951       568.89\n      55.551     0.998437        28955       640.00\n      55.999     0.998633        28963       731.43\n      56.223     0.998828        28967       853.33\n      56.607     0.999023        28972      1024.00\n      56.703     0.999121        28975      1137.78\n      57.023     0.999219        28979      1280.00\n      57.439     0.999316        28981      1462.86\n      57.695     0.999414        28985      1706.67\n      58.559     0.999512        28986      2048.00\n      59.167     0.999561        28988      2275.56\n      59.231     0.999609        28990      2560.00\n      59.295     0.999658        28991      2925.71\n      59.327     0.999707        28992      3413.33\n      59.711     0.999756        28993      4096.00\n      59.903     0.999780        28994      4551.11\n      60.031     0.999805        28995      5120.00\n      61.791     0.999829        28996      5851.43\n      61.791     0.999854        28996      6826.67\n      62.047     0.999878        28997      8192.00\n      62.047     0.999890        28997      9102.22\n      62.463     0.999902        28999     10240.00\n      62.463     0.999915        28999     11702.86\n      62.463     0.999927        28999     13653.33\n      62.463     0.999939        28999     16384.00\n      62.463     0.999945        28999     18204.44\n      62.463     0.999951        28999     20480.00\n      62.463     0.999957        28999     23405.71\n      62.463     0.999963        28999     27306.67\n      64.735     0.999969        29000     32768.00\n      64.735     1.000000        29000          inf\n#[Mean    =       32.112, StdDeviation   =       11.827]\n#[Max     =       64.704, Total count    =        29000]\n#[Buckets =           27, SubBuckets     =         2048]\n----------------------------------------------------------\n  30002 requests in 5.00m, 194.04MB read\n  Non-2xx or 3xx responses: 4769\nRequests/sec:    100.00\nTransfer/sec:    662.30KB\n",
        "150": "Running 5m test @ http://example.com\n  4 threads and 8 connections\n  Thread calibration: mean lat.: 31.210ms, rate sampling interval: 83ms\n  Thread calibration: mean lat.: 31.891ms, rate sampling interval: 86ms\n  Thread calibration: mean lat.: 33.064ms, rate sampling interval: 87ms\n  Thread calibration: mean lat.: 33.108ms, rate sampling interval: 87ms\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\n    Latency    32.26ms   11.75ms  67.52ms   75.67%\n    Req/Sec    37.18      9.69    72.00     65.98%\n  Latency Distribution (HdrHistogram - Recorded Latency)\n 50.000%   35.84ms\n 75.000%   39.84ms\n 90.000%   43.29ms\n 99.000%   50.08ms\n 99.900%   56.70ms\n 99.990%   64.45ms\n 99.999%   67.58ms\n100.000%   67.58ms\n\n  Detailed Percentile spectrum:\n       Value   Percentile   TotalCount 1/(1-Percentile)\n\n       1.698     0.000000            1         1.00\n       9.999     0.100000         4355         1.11\n      26.623     0.200000         8702         1.25\n      30.735     0.300000        13060         1.43\n      33.727     0.400000        17407         1.67\n      35.839     0.500000        21767         2.00\n      36.671     0.550000        23937         2.22\n      37.471     0.600000        26126         2.50\n      38.239     0.650000        28324         2.86\n      39.007     0.700000        30480         3.33\n      39.839     0.750000        32668         4.00\n      40.255     0.775000        33731         4.44\n      40.767     0.800000        34875         5.00\n      41.279     0.825000        35939         5.71\n      41.855     0.850000        36985         6.67\n      42.527     0.875000        38092         8.00\n      42.911     0.887500        38636         8.89\n      43.295     0.900000        39168        10.00\n      43.711     0.912500        39699        11.43\n      44.191     0.925000        40252        13.33\n      44.767     0.937500        40787        16.00\n      45.087     0.943750        41074        17.78\n      45.439     0.950000        41332        20.00\n      45.823     0.956250        41599        22.86\n      46.303     0.962500        41877        26.67\n      46.847     0.968750        42143        32.00\n      47.167     0.971875        42294        35.56\n      47.487     0.975000        42419        40.00\n      47.871     0.978125        42563        45.71\n      48.319     0.981250        42698        53.33\n      48.895     0.984375        42823        64.00\n      49.247     0.985938        42902        71.11\n      49.535     0.987500        42962        80.00\n      49.919     0.989062        43031        91.43\n      50.303     0.990625        43100       106.67\n      50.943     0.992188        43170       128.00\n      51.167     0.992969        43198       142.22\n      51.615     0.993750        43232       160.00\n      52.063     0.994531        43265       182.86\n      52.447     0.995313        43301       213.33\n      52.927     0.996094        43335       256.00\n      53.215     0.996484        43351       284.44\n      53.663     0.996875        43368       320.00\n      54.079     0.997266        43384       365.71\n      54.495     0.997656        43402       426.67\n      54.943     0.998047        43418       512.00\n      55.295     0.998242        43426       568.89\n      55.615     0.998437        43435       640.00\n      55.999     0.998633        43443       731.43\n      56.383     0.998828        43452       853.33\n      56.767     0.999023        43460      1024.00\n      57.279     0.999121        43464      1137.78\n      57.887     0.999219        43469      1280.00\n      58.527     0.999316        43474      1462.86\n      58.943     0.999414        43478      1706.67\n      59.327     0.999512        43481      2048.00\n      59.775     0.999561        43483      2275.56\n      60.575     0.999609        43486      2560.00\n      60.767     0.999658        43488      2925.71\n      61.183     0.999707        43491      3413.33\n      61.503     0.999756        43492      4096.00\n      61.695     0.999780        43493      4551.11\n      62.143     0.999805        43494      5120.00\n      62.431     0.999829        43495      5851.43\n      63.455     0.999854        43496      6826.67\n      63.647     0.999878        43497      8192.00\n      64.447     0.999890        43498      9102.22\n      64.447     0.999902        43498     10240.00\n      65.407     0.999915        43499     11702.86\n      65.407     0.999927        43499     13653.33\n      66.111     0.999939        43500     16384.00\n      66.111     0.999945        43500     18204.44\n      66.111     0.999951        43500     20480.00\n      67.199     0.999957        43501     23405.71\n      67.199     0.999963        43501     27306.67\n      67.199     0.999969        43501     32768.00\n      67.199     0.999973        43501     36408.89\n      67.199     0.999976        43501     40960.00\n      67.583     0.999979        43502     46811.43\n      67.583     1.000000        43502          inf\n#[Mean    =       32.261, StdDeviation   =       11.751]\n#[Max     =       67.520, Total count    =        43502]\n#[Buckets =           27, SubBuckets     =         2048]\n----------------------------------------------------------\n  45000 requests in 5.00m, 291.43MB read\n  Non-2xx or 3xx responses: 7119\nRequests/sec:    149.99\nTransfer/sec:      0.97MB\n",
        "200": "Running 5m test @ http://example.com\n  4 threads and 8 connections\n  Thread calibration: mean lat.: 32.037ms, rate sampling interval: 88ms\n  Thread calibration: mean lat.: 33.217ms, rate sampling interval: 91ms\n  Thread calibration: mean lat.: 34.558ms, rate sampling interval: 93ms\n  Thread calibration: mean lat.: 34.657ms, rate sampling interval: 95ms\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\n    Latency    33.64ms   12.14ms  82.37ms   74.10%\n    Req/Sec    49.73      9.93    91.00     74.01%\n  Latency Distribution (HdrHistogram - Recorded Latency)\n 50.000%   36.51ms\n 75.000%   41.18ms\n 90.000%   45.82ms\n 99.000%   55.49ms\n 99.900%   64.86ms\n 99.990%   77.18ms\n 99.999%   81.02ms\n100.000%   82.43ms\n\n  Detailed Percentile spectrum:\n       Value   Percentile   TotalCount 1/(1-Percentile)\n\n       1.709     0.000000            1         1.00\n      12.007     0.100000         5803         1.11\n      27.375     0.200000        11611         1.25\n      31.487     0.300000        17407         1.43\n      34.399     0.400000        23226         1.67\n      36.511     0.500000        29095         2.00\n      37.439     0.550000        31971         2.22\n      38.335     0.600000        34878         2.50\n      39.231     0.650000        37771         2.86\n      40.159     0.700000        40645         3.33\n      41.183     0.750000        43535         4.00\n      41.759     0.775000        44956         4.44\n      42.399     0.800000        46447         5.00\n      43.071     0.825000        47855         5.71\n      43.871     0.850000        49349         6.67\n      44.703     0.875000        50747         8.00\n      45.247     0.887500        51502         8.89\n      45.823     0.900000        52231        10.00\n      46.431     0.912500        52920        11.43\n      47.135     0.925000        53671        13.33\n      47.871     0.937500        54377        16.00\n      48.319     0.943750        54742        17.78\n      48.831     0.950000        55098        20.00\n      49.375     0.956250        55459        22.86\n      50.047     0.962500        55821        26.67\n      50.847     0.968750        56182        32.00\n      51.263     0.971875        56365        35.56\n      51.839     0.975000        56549        40.00\n      52.319     0.978125        56729        45.71\n      52.959     0.981250        56915        53.33\n      53.663     0.984375        57091        64.00\n      54.079     0.985938        57188        71.11\n      54.559     0.987500        57274        80.00\n      55.167     0.989062        57362        91.43\n      55.743     0.990625        57456       106.67\n      56.479     0.992188        57542       128.00\n      56.959     0.992969        57589       142.22\n      57.503     0.993750        57635       160.00\n      58.047     0.994531        57677       182.86\n      58.527     0.995313        57724       213.33\n      59.295     0.996094        57769       256.00\n      59.807     0.996484        57792       284.44\n      60.095     0.996875        57814       320.00\n      60.543     0.997266        57837       365.71\n      61.343     0.997656        57860       426.67\n      62.271     0.998047        57882       512.00\n      62.751     0.998242        57893       568.89\n      63.199     0.998437        57904       640.00\n      63.583     0.998633        57915       731.43\n      64.383     0.998828        57928       853.33\n      64.927     0.999023        57938      1024.00\n      65.439     0.999121        57945      1137.78\n      65.599     0.999219        57949      1280.00\n      66.623     0.999316        57955      1462.86\n      67.327     0.999414        57961      1706.67\n      67.519     0.999512        57966      2048.00\n      68.351     0.999561        57969      2275.56\n      69.311     0.999609        57972      2560.00\n      70.015     0.999658        57975      2925.71\n      70.847     0.999707        57978      3413.33\n      71.999     0.999756        57980      4096.00\n      72.895     0.999780        57982      4551.11\n      73.023     0.999805        57984      5120.00\n      73.983     0.999829        57985      5851.43\n      75.839     0.999854        57986      6826.67\n      76.735     0.999878        57987      8192.00\n      77.183     0.999890        57988      9102.22\n      78.335     0.999902        57989     10240.00\n      78.911     0.999915        57990     11702.86\n      78.911     0.999927        57990     13653.33\n      79.423     0.999939        57991     16384.00\n      79.423     0.999945        57991     18204.44\n      79.487     0.999951        57992     20480.00\n      79.487     0.999957        57992     23405.71\n      79.487     0.999963        57992     27306.67\n      81.023     0.999969        57993     32768.00\n      81.023     0.999973        57993     36408.89\n      81.023     0.999976        57993     40960.00\n      81.023     0.999979        57993     46811.43\n      81.023     0.999982        57993     54613.33\n      82.431     0.999985        57994     65536.00\n      82.431     1.000000        57994          inf\n#[Mean    =       33.639, StdDeviation   =       12.140]\n#[Max     =       82.368, Total count    =        57994]\n#[Buckets =           27, SubBuckets     =         2048]\n----------------------------------------------------------\n  59997 requests in 5.00m, 388.93MB read\n  Non-2xx or 3xx responses: 9384\nRequests/sec:    199.99\nTransfer/sec:      1.30MB\n",
        "250": "Running 5m test @ http://example.com\n  4 threads and 8 connections\n  Thread calibration: mean lat.: 135.136ms, rate sampling interval: 438ms\n  Thread calibration: mean lat.: 147.696ms, rate sampling interval: 453ms\n  Thread calibration: mean lat.: 134.159ms, rate sampling interval: 529ms\n  Thread calibration: mean lat.: 170.339ms, rate sampling interval: 612ms\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\n    Latency     2.50s     1.40s    5.57s    57.64%\n    Req/Sec    61.13      4.17    75.00     82.91%\n  Latency Distribution (HdrHistogram - Recorded Latency)\n 50.000%    2.44s \n 75.000%    3.72s \n 90.000%    4.44s \n 99.000%    5.05s \n 99.900%    5.42s \n 99.990%    5.53s \n 99.999%    5.57s \n100.000%    5.57s \n\n  Detailed Percentile spectrum:\n       Value   Percentile   TotalCount 1/(1-Percentile)\n\n       2.781     0.000000            1         1.00\n     623.103     0.100000         7152         1.11\n    1010.175     0.200000        14286         1.25\n    1497.087     0.300000        21440         1.43\n    1952.767     0.400000        28569         1.67\n    2435.071     0.500000        35723         2.00\n    2686.975     0.550000        39291         2.22\n    2985.983     0.600000        42849         2.50\n    3225.599     0.650000        46436         2.86\n    3497.983     0.700000        49990         3.33\n    3723.263     0.750000        53589         4.00\n    3813.375     0.775000        55345         4.44\n    3936.255     0.800000        57133         5.00\n    4065.279     0.825000        58914         5.71\n    4177.919     0.850000        60705         6.67\n    4317.183     0.875000        62507         8.00\n    4370.431     0.887500        63386         8.89\n    4435.967     0.900000        64267        10.00\n    4497.407     0.912500        65178        11.43\n    4542.463     0.925000        66082        13.33\n    4595.711     0.937500        66945        16.00\n    4632.575     0.943750        67404        17.78\n    4669.439     0.950000        67854        20.00\n    4714.495     0.956250        68300        22.86\n    4771.839     0.962500        68749        26.67\n    4820.991     0.968750        69209        32.00\n    4841.471     0.971875        69442        35.56\n    4861.951     0.975000        69631        40.00\n    4890.623     0.978125        69854        45.71\n    4919.295     0.981250        70081        53.33\n    4964.351     0.984375        70292        64.00\n    4993.023     0.985938        70403        71.11\n    5021.695     0.987500        70533        80.00\n    5038.079     0.989062        70627        91.43\n    5058.559     0.990625        70737       106.67\n    5091.327     0.992188        70863       128.00\n    5099.519     0.992969        70906       142.22\n    5111.807     0.993750        70967       160.00\n    5128.191     0.994531        71028       182.86\n    5148.671     0.995313        71088       213.33\n    5177.343     0.996094        71134       256.00\n    5193.727     0.996484        71161       284.44\n    5210.111     0.996875        71184       320.00\n    5226.495     0.997266        71216       365.71\n    5263.359     0.997656        71241       426.67\n    5292.031     0.998047        71270       512.00\n    5300.223     0.998242        71283       568.89\n    5341.183     0.998437        71295       640.00\n    5382.143     0.998633        71310       731.43\n    5402.623     0.998828        71323       853.33\n    5419.007     0.999023        71337      1024.00\n    5431.295     0.999121        71345      1137.78\n    5439.487     0.999219        71351      1280.00\n    5447.679     0.999316        71361      1462.86\n    5459.967     0.999414        71367      1706.67\n    5476.351     0.999512        71372      2048.00\n    5480.447     0.999561        71375      2275.56\n    5492.735     0.999609        71382      2560.00\n    5492.735     0.999658        71382      2925.71\n    5496.831     0.999707        71386      3413.33\n    5505.023     0.999756        71390      4096.00\n    5509.119     0.999780        71391      4551.11\n    5513.215     0.999805        71393      5120.00\n    5517.311     0.999829        71395      5851.43\n    5521.407     0.999854        71396      6826.67\n    5525.503     0.999878        71398      8192.00\n    5529.599     0.999890        71400      9102.22\n    5529.599     0.999902        71400     10240.00\n    5529.599     0.999915        71400     11702.86\n    5533.695     0.999927        71402     13653.33\n    5533.695     0.999939        71402     16384.00\n    5537.791     0.999945        71403     18204.44\n    5537.791     0.999951        71403     20480.00\n    5537.791     0.999957        71403     23405.71\n    5550.079     0.999963        71404     27306.67\n    5550.079     0.999969        71404     32768.00\n    5566.463     0.999973        71405     36408.89\n    5566.463     0.999976        71405     40960.00\n    5566.463     0.999979        71405     46811.43\n    5566.463     0.999982        71405     54613.33\n    5566.463     0.999985        71405     65536.00\n    5570.559     0.999986        71406     72817.78\n    5570.559     1.000000        71406          inf\n#[Mean    =     2499.278, StdDeviation   =     1397.541]\n#[Max     =     5566.464, Total count    =        71406]\n#[Buckets =           27, SubBuckets     =         2048]\n----------------------------------------------------------\n  73861 requests in 5.00m, 477.88MB read\n  Non-2xx or 3xx responses: 11661\nRequests/sec:    246.19\nTransfer/sec:      1.59MB\n",
        "300": "Running 5m test @ http://example.com\n  4 threads and 8 connections\n  Thread calibration: mean lat.: 893.633ms, rate sampling interval: 3092ms\n  Thread calibration: mean lat.: 953.702ms, rate sampling interval: 3377ms\n  Thread calibration: mean lat.: 981.363ms, rate sampling interval: 3479ms\n  Thread calibration: mean lat.: 929.932ms, rate sampling interval: 3149ms\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\n    Latency    27.90s    15.10s    0.91m    57.64%\n    Req/Sec    61.03      1.50    66.00     90.37%\n  Latency Distribution (HdrHistogram - Recorded Latency)\n 50.000%   27.92s \n 75.000%   41.16s \n 90.000%   48.73s \n 99.000%    0.89m \n 99.900%    0.90m \n 99.990%    0.91m \n 99.999%    0.91m \n100.000%    0.91m \n\n  Detailed Percentile spectrum:\n       Value   Percentile   TotalCount 1/(1-Percentile)\n\n    1655.807     0.000000            1         1.00\n    7135.231     0.100000         7139         1.11\n   12304.383     0.200000        14290         1.25\n   17367.039     0.300000        21420         1.43\n   22315.007     0.400000        28562         1.67\n   27918.335     0.500000        35692         2.00\n   30539.775     0.550000        39267         2.22\n   33144.831     0.600000        42833         2.50\n   35880.959     0.650000        46413         2.86\n   38535.167     0.700000        49984         3.33\n   41156.607     0.750000        53561         4.00\n   42401.791     0.775000        55357         4.44\n   43810.815     0.800000        57125         5.00\n   45023.231     0.825000        58899         5.71\n   46268.415     0.850000        60695         6.67\n   47448.063     0.875000        62459         8.00\n   48070.655     0.887500        63393         8.89\n   48726.015     0.900000        64250        10.00\n   49414.143     0.912500        65149        11.43\n   50135.039     0.925000        66039        13.33\n   50823.167     0.937500        66943        16.00\n   51085.311     0.943750        67383        17.78\n   51412.991     0.950000        67831        20.00\n   51707.903     0.956250        68300        22.86\n   52035.583     0.962500        68743        26.67\n   52330.495     0.968750        69172        32.00\n   52494.335     0.971875        69412        35.56\n   52592.639     0.975000        69634        40.00\n   52723.711     0.978125        69849        45.71\n   52887.551     0.981250        70072        53.33\n   53051.391     0.984375        70305        64.00\n   53116.927     0.985938        70378        71.11\n   53247.999     0.987500        70503        80.00\n   53346.303     0.989062        70615        91.43\n   53477.375     0.990625        70746       106.67\n   53575.679     0.992188        70829       128.00\n   53641.215     0.992969        70906       142.22\n   53706.751     0.993750        70957       160.00\n   53772.287     0.994531        71011       182.86\n   53837.823     0.995313        71059       213.33\n   53903.359     0.996094        71115       256.00\n   53936.127     0.996484        71135       284.44\n   53968.895     0.996875        71166       320.00\n   54001.663     0.997266        71186       365.71\n   54067.199     0.997656        71222       426.67\n   54099.967     0.998047        71243       512.00\n   54132.735     0.998242        71265       568.89\n   54165.503     0.998437        71279       640.00\n   54198.271     0.998633        71294       731.43\n   54231.039     0.998828        71316       853.33\n   54231.039     0.999023        71316      1024.00\n   54263.807     0.999121        71347      1137.78\n   54263.807     0.999219        71347      1280.00\n   54263.807     0.999316        71347      1462.86\n   54263.807     0.999414        71347      1706.67\n   54263.807     0.999512        71347      2048.00\n   54296.575     0.999561        71366      2275.56\n   54296.575     0.999609        71366      2560.00\n   54296.575     0.999658        71366      2925.71\n   54296.575     0.999707        71366      3413.33\n   54296.575     0.999756        71366      4096.00\n   54296.575     0.999780        71366      4551.11\n   54329.343     0.999805        71371      5120.00\n   54329.343     0.999829        71371      5851.43\n   54329.343     0.999854        71371      6826.67\n   54362.111     0.999878        71373      8192.00\n   54362.111     0.999890        71373      9102.22\n   54394.879     0.999902        71376     10240.00\n   54394.879     0.999915        71376     11702.86\n   54394.879     0.999927        71376     13653.33\n   54394.879     0.999939        71376     16384.00\n   54427.647     0.999945        71379     18204.44\n   54427.647     0.999951        71379     20480.00\n   54427.647     0.999957        71379     23405.71\n   54427.647     0.999963        71379     27306.67\n   54427.647     0.999969        71379     32768.00\n   54427.647     0.999973        71379     36408.89\n   54427.647     0.999976        71379     40960.00\n   54427.647     0.999979        71379     46811.43\n   54427.647     0.999982        71379     54613.33\n   54427.647     0.999985        71379     65536.00\n   54460.415     0.999986        71380     72817.78\n   54460.415     1.000000        71380          inf\n#[Mean    =    27901.970, StdDeviation   =    15101.829]\n#[Max     =    54427.648, Total count    =        71380]\n#[Buckets =           27, SubBuckets     =         2048]\n----------------------------------------------------------\n  73845 requests in 5.00m, 477.77MB read\n  Non-2xx or 3xx responses: 11658\nRequests/sec:    246.14\nTransfer/sec:      1.59MB\n",
        "350": "Running 5m test @ http://example.com\n  4 threads and 8 connections\n  Thread calibration: mean lat.: 1568.558ms, rate sampling interval: 5447ms\n  Thread calibration: mean lat.: 1552.501ms, rate sampling interval: 5435ms\n  Thread calibration: mean lat.: 1556.837ms, rate sampling interval: 5472ms\n  Thread calibration: mean lat.: 1523.884ms, rate sampling interval: 5402ms\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\n    Latency    46.10s    24.85s    1.49m    57.69%\n    Req/Sec    61.13      1.13    65.00     91.94%\n  Latency Distribution (HdrHistogram - Recorded Latency)\n 50.000%   46.33s \n 75.000%    1.13m \n 90.000%    1.34m \n 99.000%    1.47m \n 99.900%    1.48m \n 99.990%    1.49m \n 99.999%    1.49m \n100.000%    1.49m \n\n  Detailed Percentile spectrum:\n       Value   Percentile   TotalCount 1/(1-Percentile)\n\n    2881.535     0.000000            1         1.00\n   11698.175     0.100000         7149         1.11\n   20283.391     0.200000        14296         1.25\n   28835.839     0.300000        21444         1.43\n   37257.215     0.400000        28581         1.67\n   46333.951     0.500000        35741         2.00\n   50593.791     0.550000        39307         2.22\n   54853.631     0.600000        42869         2.50\n   59211.775     0.650000        46441         2.86\n   63504.383     0.700000        50027         3.33\n   67829.759     0.750000        53613         4.00\n   69861.375     0.775000        55407         4.44\n   72024.063     0.800000        57171         5.00\n   74186.751     0.825000        58987         5.71\n   76283.903     0.850000        60751         6.67\n   78249.983     0.875000        62530         8.00\n   79233.023     0.887500        63449         8.89\n   80347.135     0.900000        64324        10.00\n   81526.783     0.912500        65225        11.43\n   82640.895     0.925000        66133        13.33\n   83689.471     0.937500        66983        16.00\n   84279.295     0.943750        67465        17.78\n   84803.583     0.950000        67890        20.00\n   85327.871     0.956250        68349        22.86\n   85786.623     0.962500        68788        26.67\n   86179.839     0.968750        69224        32.00\n   86441.983     0.971875        69453        35.56\n   86704.127     0.975000        69682        40.00\n   86966.271     0.978125        69910        45.71\n   87228.415     0.981250        70118        53.33\n   87490.559     0.984375        70354        64.00\n   87621.631     0.985938        70447        71.11\n   87818.239     0.987500        70601        80.00\n   87949.311     0.989062        70710        91.43\n   88080.383     0.990625        70806       106.67\n   88211.455     0.992188        70897       128.00\n   88342.527     0.992969        70973       142.22\n   88408.063     0.993750        71026       160.00\n   88473.599     0.994531        71064       182.86\n   88604.671     0.995313        71147       213.33\n   88670.207     0.996094        71185       256.00\n   88735.743     0.996484        71220       284.44\n   88801.279     0.996875        71256       320.00\n   88801.279     0.997266        71256       365.71\n   88866.815     0.997656        71290       426.67\n   88932.351     0.998047        71326       512.00\n   88932.351     0.998242        71326       568.89\n   88997.887     0.998437        71364       640.00\n   88997.887     0.998633        71364       731.43\n   88997.887     0.998828        71364       853.33\n   89063.423     0.999023        71389      1024.00\n   89063.423     0.999121        71389      1137.78\n   89128.959     0.999219        71399      1280.00\n   89128.959     0.999316        71399      1462.86\n   89194.495     0.999414        71407      1706.67\n   89260.031     0.999512        71420      2048.00\n   89260.031     0.999561        71420      2275.56\n   89260.031     0.999609        71420      2560.00\n   89325.567     0.999658        71431      2925.71\n   89325.567     0.999707        71431      3413.33\n   89325.567     0.999756        71431      4096.00\n   89325.567     0.999780        71431      4551.11\n   89391.103     0.999805        71438      5120.00\n   89391.103     0.999829        71438      5851.43\n   89391.103     0.999854        71438      6826.67\n   89391.103     0.999878        71438      8192.00\n   89391.103     0.999890        71438      9102.22\n   89456.639     0.999902        71442     10240.00\n   89456.639     0.999915        71442     11702.86\n   89456.639     0.999927        71442     13653.33\n   89456.639     0.999939        71442     16384.00\n   89456.639     0.999945        71442     18204.44\n   89456.639     0.999951        71442     20480.00\n   89456.639     0.999957        71442     23405.71\n   89522.175     0.999963        71445     27306.67\n   89522.175     1.000000        71445          inf\n#[Mean    =    46096.110, StdDeviation   =    24852.993]\n#[Max     =    89456.640, Total count    =        71445]\n#[Buckets =           27, SubBuckets     =         2048]\n----------------------------------------------------------\n  73893 requests in 5.00m, 478.06MB read\n  Non-2xx or 3xx responses: 11669\nRequests/sec:    246.30\nTransfer/sec:      1.59MB\n"
      };

      function onLoadCallback() {
        drawChart(parseReport(exampleReport));
      }

      function onInputChange(files) {
        const selectedFile = files[0];
        selectedFile.text().then(text => JSON.parse(text)).then(parseReport).then(drawChart);
      }

      function onSelectChange(a) {
        console.log(a)
      }

      const percentiles = ["50.000%", "75.000%", "90.000%", "99.000%", "99.900%", "99.990%", "99.999%"];
      const regexs = {
        total: new RegExp(/^\s*(\d+) requests in/),
        error: new RegExp(/^\s*Non-2xx or 3xx responses: (\d+)\s*$/),
        throughput: new RegExp(/^\s*Requests\/sec:\s*(.+)\s*$/),
        percentile(name) {
          return new RegExp(`^\\s*${name}\\s*(.+)\\s*$`);
        }
      };

      function parseReport(report) {
        const data = {};
        for (const rate in report) {
          const stdout = report[rate];
          // console.log(stdout);
          const lines = stdout.split('\n');
          const item = data[rate] = {percentiles: {}, total: 0, error: 0, throughput: 0};
          percentiles.map(percentile => {
            lines.forEach(line => {
              const matches = regexs.percentile(percentile).exec(line);
              if (matches) {
                item.percentiles[percentile] = getMillis(matches[1].trim());
              }
            });
          });
          lines.forEach(line => {
            let matches = regexs.total.exec(line);
            if (matches) {
              item.total = Number(matches[1].trim());
            }
            matches = regexs.error.exec(line);
            if (matches) {
              item.error = Number(matches[1].trim());
            }
            matches = regexs.throughput.exec(line);
            if (matches) {
              item.throughput = Number(matches[1].trim());
            }
          });
        }
        return data;
      }

      // get milliseconds from string time representation
      function getMillis(str) {
        if (str.endsWith('ms')) {
          return Number(str.slice(0, -2))
        }

        if (str.endsWith('s')) {
          return Number(str.slice(0, -1)) * 1000
        }

        if (str.endsWith('m')) {
          return Number(str.slice(0, -1)) * 60 * 1000
        }

        throw new Error(`unhandled time unit ${str}`);
      }

      function drawChart(report) {
        console.log('draw chart for report', report);

        const latencyRows = [['Rate (Req/s)'].concat(percentiles)];
        const throughputRows = [['Rate (Req/s)', 'Throughput']];
        const errRows = [['Rate (Req/s)', 'Error Rate']];

        for (const rate in report) {
          const item = report[rate];
          latencyRows.push([rate].concat(Object.values(item.percentiles)));
          throughputRows.push([rate, item.throughput]);
          errRows.push([rate, (item.error / item.total) * 100]);
        }

        new google.visualization.LineChart(document.getElementById('latency'))
          .draw(google.visualization.arrayToDataTable(latencyRows), {
            title: 'Latency by Rate',
            curveType: 'function',
            focusTarget: 'category',
            explorer: {
              actions: ['dragToZoom', 'rightClickToReset']
            },
            hAxis: {
              title: 'Rate (Req/s)',
            },
            vAxis: {
              title: 'Latency (ms)',
              viewWindow: {
                min: 0
              }
            }
            // width: 1500,
            // height: 600,
          });

        new google.visualization.LineChart(document.getElementById('throughput'))
          .draw(google.visualization.arrayToDataTable(throughputRows), {
            title: 'Throughput by Rate',
            curveType: 'function',
            focusTarget: 'category',
            hAxis: {
              title: 'Rate (Req/s)',
            },
            vAxis: {
              title: 'Throughput (Req/s)',
              viewWindow: {
                min: 0
              }
            }
            // width: 1500,
            // height: 600,
          });

        new google.visualization.LineChart(document.getElementById('error-rate'))
          .draw(google.visualization.arrayToDataTable(errRows), {
            title: 'Error Rate by Rate',
            curveType: 'function',
            focusTarget: 'category',
            hAxis: {
              title: 'Rate (Req/s)',
            },
            vAxis: {
              title: 'Error Rate (%)',
              viewWindow: {
                min: 0,
                max: 100
              }
            }
            // width: 1500,
            // height: 600,
          });
      }
    </script>
</head>

<body>
<h1>HTTP Benchmark Report Renderer</h1>
<div>
    <label>Select file here to render</label> <input type="file" id="input" onchange="onInputChange(this.files)">
</div>
<!--<div>-->
<!--    <label>Graph Type</label>-->
<!--    <select onchange="onSelectChange(this)">-->
<!--        <option value="latency">Latency by Rate</option>-->
<!--        <option value="throughput">Throughput by Rate</option>-->
<!--        <option value="error-rate">Error Rate by Rate</option>-->
<!--    </select>-->
<!--</div>-->
<div id="latency" style="width: 100%; height: 600px"></div>
<div id="throughput" style="width: 100%; height: 600px"></div>
<div id="error-rate" style="width: 100%; height: 600px"></div>
</body>
</html>